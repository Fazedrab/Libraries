--[[

All arguments are optional

Library:New(length,color) > Creates new Library
	Library:Window(title) > Creates new Window
		Window:Text(text) > Creates new Button
			Button:Click() > Artificially clicks the button
			Button:SetText(text) > Changes text of button
			Button:Destroy() > Deletes the button
		Window:Button(text,callback) > Creates new Button
			Button:Click() > Artificially clicks the button
			Button:SetText(text) > Changes text of button
			Button:Destroy() > Deletes the button
		Window:Toggle(text,callback,default) > Creates new Toggle
			Toggle:Set(value) > Turns the toggle on or off
			Toggle:Get() > Gets the value of the toggle
			Toggle:Destroy() > Deletes the toggle
	Window:ToggleVisibility() > Hides or shows all the windows

]]












local ts,uis = game:GetService("TweenService"),game:GetService("UserInputService")

local lib = {}

function lib:New(length,color)
	length = length or 200
	color = color or Color3.new(0.117647, 0.901961, 0)
	local ui = {}
	local oldframepos = {}
	local enabled = true
	local function dragify(Frame)
		local dragToggle,dragInput,dragStart,dragPos,startPos
		Frame.InputBegan:Connect(function(input)
			if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
				dragToggle = true
				dragStart = input.Position
				startPos = Frame.Position
				input.Changed:Connect(function()
					if (input.UserInputState == Enum.UserInputState.End) then
						dragToggle = false
					end
				end)
			end
		end)
		Frame.InputChanged:Connect(function(input)
			if (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
				dragInput = input
			end
		end)
		uis.InputChanged:Connect(function(input)
			if (input == dragInput and dragToggle) then
				local Delta = input.Position - dragStart
				local Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + Delta.X, startPos.Y.Scale, startPos.Y.Offset + Delta.Y)
				ts:Create(Frame, TweenInfo.new(.25), {Position = Position}):Play()
				oldframepos[Frame] = Position
			end
		end)
	end
	local sg = Instance.new("ScreenGui")
	function ui:Window(title)
		title = title or "Title"
		local window = {}
		local dropped = false
		local dy = 0
		local top = Instance.new("Frame")
		top.Position = UDim2.fromOffset(150,200)
		top.Size = UDim2.fromOffset(length,30)
		top.BackgroundColor3 = color
		top.BorderSizePixel = 0
		local dd = Instance.new("ImageLabel")
		dd.Image = "http://www.roblox.com/asset/?id=1215682490"
		dd.Rotation = 90
		dd.BackgroundTransparency = 1
		dd.ImageTransparency = .25
		dd.Position = UDim2.fromOffset(length-25,5)
		dd.ImageColor3 = Color3.new(1, 1, 1)
		dd.Size = UDim2.fromOffset(20,20)
		local t = Instance.new("TextLabel")
		t.BackgroundTransparency = 1
		t.TextColor3 = Color3.new(1,1,1)
		t.Text = " "..title
		t.TextXAlignment = Enum.TextXAlignment.Left
		t.TextSize = 20
		t.Font = Enum.Font.Code
		t.Size = UDim2.fromOffset(length-30,30)
		local drop = Instance.new("Frame")
		drop.BorderSizePixel = 0
		drop.BackgroundColor3 = Color3.new()
		drop.BackgroundTransparency = .5
		drop.Size = UDim2.fromOffset(length,dy)
		drop.ClipsDescendants = true
		drop.Position = UDim2.fromScale(0,1)
		local beg
		top.InputBegan:Connect(function(input)
			if input.UserInputType == Enum.UserInputType.MouseButton1 then
				beg = uis:GetMouseLocation()
			end
		end)
		top.InputEnded:Connect(function(input)
			if beg and input.UserInputType == Enum.UserInputType.MouseButton1 and (uis:GetMouseLocation()-beg).Magnitude < 10 then
				if dropped then
					dropped = false
					drop:TweenSize(UDim2.fromOffset(length,0),Enum.EasingDirection.Out,Enum.EasingStyle.Quad,0.3,true)
					ts:Create(dd, TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Rotation = 90}):Play()
					ts:Create(dd, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {ImageTransparency = 0}):Play()
				else
					dropped = true
					drop:TweenSize(UDim2.fromOffset(length,dy),Enum.EasingDirection.Out,Enum.EasingStyle.Quad,0.3,true)
					ts:Create(dd, TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Rotation = 180}):Play()
					ts:Create(dd, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {ImageTransparency = 0}):Play()
				end
			end
		end)
		top.MouseEnter:Connect(function()
			ts:Create(dd, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {ImageTransparency = 0}):Play()
		end)
		top.MouseLeave:Connect(function()
			beg = nil
			ts:Create(dd, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {ImageTransparency = 0.25}):Play()
		end)
		function window:Button(text,callback)
			local blib = {}
			text = text or "Text"
			callback = callback or function() end
			local b = Instance.new("TextButton")
			b.BackgroundTransparency = 1
			b.Size = UDim2.new(1,-5,0,30)
			b.BackgroundTransparency = 1
			b.TextColor3 = Color3.new(1,1,1)
			b.Font = Enum.Font.Code
			b.TextTransparency = .25
			b.Text = text
			b.TextXAlignment = Enum.TextXAlignment.Left
			b.TextSize = 16
			b.Position = UDim2.fromOffset(5,dy)
			dy += 30
			b.MouseEnter:Connect(function()
				ts:Create(b, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
			end)
			b.MouseLeave:Connect(function()
				beg = nil
				ts:Create(b, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0.25}):Play()
			end)
			b.MouseButton1Down:Connect(function()
				ts:Create(b, TweenInfo.new(0, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0.35}):Play()
			end)
			b.MouseButton1Up:Connect(function()
				ts:Create(b, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
			end)
			b.MouseButton1Click:Connect(function()
				callback()
			end)
			function blib:Click()
				b.TextTransparency = .35
				ts:Create(b, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
				callback()
			end
			function blib:SetText(text)
				text = text or "?"
				b.Text = text
			end
			function blib:Destroy()
				dy -= 30
				drop.Size = UDim2.fromOffset(length,dy)
				b:Destroy()
			end
			b.Parent = drop
		end
		function window:Text(text)
			local tlib = {}
			text = text or "Text"
			local t = Instance.new("TextButton")
			t.BackgroundTransparency = 1
			t.Size = UDim2.new(1,-5,0,30)
			t.BackgroundTransparency = 1
			t.TextColor3 = Color3.new(1,1,1)
			t.Font = Enum.Font.Code
			t.TextTransparency = 0
			t.Text = text
			t.TextXAlignment = Enum.TextXAlignment.Left
			t.TextSize = 16
			t.Position = UDim2.fromOffset(5,dy)
			dy += 30
			function tlib:SetText(text)
				text = text or "?"
				t.Text = text
			end
			function tlib:Destroy()
				dy -= 30
				drop.Size = UDim2.fromOffset(length,dy)
				t:Destroy()
			end
			t.Parent = drop
		end
		function window:Toggle(text,callback,default)
			local toggle = {}
			text = text or "Text"
			callback = callback or function() end
			local toggled = default or false
			local wb = Instance.new("TextButton")
			wb.BackgroundTransparency = 1
			wb.Text = ""
			wb.ZIndex = 2
			wb.Size = UDim2.new(1,0,0,30)
			wb.Position = UDim2.fromOffset(0,dy)
			local b = Instance.new("TextButton")
			b.BackgroundTransparency = 1
			b.Size = UDim2.new(1,-30,0,30)
			b.BackgroundTransparency = 1
			b.TextColor3 = Color3.new(1,1,1)
			b.Font = Enum.Font.Code
			b.TextTransparency = .25
			b.Text = text
			b.TextXAlignment = Enum.TextXAlignment.Left
			b.TextSize = 16
			b.Position = UDim2.fromOffset(30,dy)
			local on = Instance.new("Frame")
			on.BorderSizePixel = 0
			on.BackgroundColor3 = color
			local base = dy
			local bgon = Instance.new("Frame")
			bgon.BorderSizePixel = 0
			bgon.BackgroundTransparency = .35
			bgon.BackgroundColor3 = Color3.new()
			bgon.Size = UDim2.fromOffset(20,20)
			bgon.Position = UDim2.fromOffset(5,base+5)
			local uic = Instance.new("UICorner")
			dy += 30
			uic.CornerRadius = UDim.new(.1)
			wb.MouseEnter:Connect(function()
				ts:Create(b, TweenInfo.new(0.13, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
			end)
			wb.MouseLeave:Connect(function()
				beg = nil
				ts:Create(b, TweenInfo.new(0.13, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0.25}):Play()
			end)
			wb.MouseButton1Down:Connect(function()
				ts:Create(b, TweenInfo.new(0, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0.35}):Play()
			end)
			wb.MouseButton1Up:Connect(function()
				ts:Create(b, TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {TextTransparency = 0}):Play()
			end)
			local function refresh()
				if toggled then
					on:TweenSizeAndPosition(UDim2.fromOffset(20,20),UDim2.fromOffset(5,base+5),Enum.EasingDirection.Out,Enum.EasingStyle.Quad,0.08,true)
				else
					on:TweenSizeAndPosition(UDim2.fromOffset(0,20),UDim2.fromOffset(15,base+5),Enum.EasingDirection.In,Enum.EasingStyle.Quad,0.08,true)
				end
			end
			wb.MouseButton1Click:Connect(function()
				toggled = not toggled
				callback(toggled)
				refresh()
			end)
			function toggle:Destroy()
				bgon:Destroy()
				on:Destroy()
				wb:Destroy()
				b:Destroy()
				dy -= 30
				drop.Size = UDim2.fromOffset(length,dy)
			end
			function toggle:Set(value)
				toggled = value or not toggled
				refresh()
			end
			function toggle:Get()
				return toggled
			end
			uic:Clone().Parent = bgon
			uic.Parent = on
			bgon.Parent = drop
			on.Parent = drop
			wb.Parent = drop
			b.Parent = drop
			refresh()
		end
		t.Parent = top
		dd.Parent = top
		drop.Parent = top
		top.Parent = sg
		dragify(top)
		oldframepos[top] = top.Position
		return window
	end
	function ui:ToggleVisibility()
		if enabled then
			for _,v in pairs(sg:GetChildren()) do
				v:TweenPosition(UDim2.new(-2,0,v.Position.Y.Scale,v.Position.Y.Offset),Enum.EasingDirection.In,Enum.EasingStyle.Quad,0.5,true,function()
					if v.Position == UDim2.new(-2,0,v.Position.Y.Scale,v.Position.Y.Offset) then
						v.Visible = false
					end
				end)
			end
			enabled = false
		else
			for _,v in pairs(sg:GetChildren()) do
				v.Visible = true
				v:TweenPosition(oldframepos[v],Enum.EasingDirection.Out,Enum.EasingStyle.Sine,0.5,true)
			end
			enabled = true
		end
	end
	function ui:Destroy()
		sg:Destroy()
	end
	sg.Parent = game.Players.LocalPlayer.PlayerGui
	return ui
end

return lib
